(this["webpackJsonpecoled-collage"]=this["webpackJsonpecoled-collage"]||[]).push([[0],{127:function(e,t,n){"use strict";n.r(t);var a=n(2),i=n.n(a),o=n(52),r=n.n(o),l=(n(67),n(35)),c=n(36),s=n(15),d=n(53),h=n.n(d),u=n(19),g=n(34),f=n(37),m=n.n(f),w=n(28),p=n(136),b=n(54);function y(){var e=Object(l.a)(["\n      query query {\n        shop {\n          name\n        }\n      }\n    "]);return y=function(){return e},e}function v(){var e=Object(l.a)(['\n      query query {\n        node(id: "','") {\n          ... on Product {\n            images(first: 100) {\n              edges {\n                node {\n                  originalSrc\n                  altText\n                }\n              }\n            }\n          }\n        }\n      }\n    ']);return v=function(){return e},e}var x=Object(p.a)({outerContainer:{height:"100vh",display:"flex"},stageContainerAfterUpload:{width:"100%",alignContent:"center",alignItems:"center"},buttonContainerAfterUpload:{width:"100%",position:"absolute",bottom:0,display:"flex",justifyContent:"space-evenly"},buttonContainerBeforeUpload:{width:"100%"},singleButtonContainerBeforeUpload:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},singleButtonContainerAfterUpload:{width:"48%",display:"flex",justifyContent:"center",alignItems:"center"},button:{background:"#252a2b",fontFamily:"sans-serif",fontStyle:"normal",color:"white",border:"2px solid transparent",fontWeight:700,textTransform:"uppercase",cursor:"pointer",borderRadius:0,padding:"15px 30px",textAlign:"center",width:"100%",alignSelf:"stretch"},buttonBeforeUpload:{background:"#252a2b",fontFamily:"sans-serif",fontStyle:"normal",color:"white",border:"2px solid transparent",fontWeight:700,textTransform:"uppercase",cursor:"pointer",borderRadius:0,padding:"15px 30px",width:"50%",display:"flex",alignSelf:"center",justifyContent:"center"}}),C=function(e){var t,n,a=e.backgroundImage,o=e.data,r=e.shapeProps,l=e.isSelected,d=e.onSelect,g=e.onChange,f=i.a.useState(null),m=Object(s.a)(f,2),w=m[0],p=m[1];o&&o.node&&o.node.images&&0!==o.node.images.edges.length&&null===w&&o.node.images.edges.forEach((function(e){"collage"===e.node.altText&&p(e.node.originalSrc)}));var b=h()(w,"Anonymous"),y=Object(s.a)(b,1)[0];if(y&&r&&null===r.height&&null===r.width){var v=y.width/y.height;a&&(n=(t=a.height>a.width&&window.innerHeight>window.innerWidth?window.innerHeight/4:a.height>a.width&&window.innerHeight<window.innerWidth?window.innerHeight/3:a.height<a.width&&window.innerHeight>window.innerWidth?window.innerHeight/6:window.innerHeight/3)*v,r.width=n,r.height=t)}var x=i.a.useRef(),C=i.a.useRef();return i.a.useEffect((function(){l&&(C.current.setNode(x.current),C.current.getLayer().batchDraw())}),[l]),i.a.createElement(i.a.Fragment,null,i.a.createElement(u.Image,Object.assign({crossOrigin:"anonymus",fill:"",image:y,onTap:d,onClick:d,ref:x},r,{draggable:!0,onDragEnd:function(e){g(Object(c.a)({},r,{x:e.target.x(),y:e.target.y()}))},onTransformEnd:function(e){var t=x.current,n=t.scaleX(),a=t.scaleY();t.scaleX(1),t.scaleY(1),g(Object(c.a)({},r,{x:t.x(),y:t.y(),width:Math.max(5,t.width()*n),height:Math.max(t.height()*a)}))}})),l&&i.a.createElement(u.Transformer,{ref:C,boundBoxFunc:function(e,t){return t.width<5||t.height<5?e:t}}))},j=function(){var e,t=window.location.search,n=new URLSearchParams(t).get("product_id");n?(n=btoa("gid://shopify/Product/"+n),e=m()(v(),n)):e=m()(y());var a=x(),o=Object(g.a)(e).data,r=i.a.createRef(),l=new Image,c=i.a.useState(null),d=Object(s.a)(c,2),h=d[0],f=d[1],p=i.a.useState(null),j=Object(s.a)(p,2),E=j[0],S=j[1],O=i.a.useState(!1),B=Object(s.a)(O,2),U=B[0],k=B[1],A=i.a.useState(window.innerHeight),H=Object(s.a)(A,2),T=H[0],W=H[1],I=i.a.useState(window.innerWidth),N=Object(s.a)(I,2),R=N[0],q=N[1],F=i.a.useState(null),L=Object(s.a)(F,2),P=L[0],M=L[1],D=i.a.useState(null),X=Object(s.a)(D,2),J=X[0],Y=X[1],$=i.a.useState(null),_=Object(s.a)($,2),z=_[0],G=_[1];function K(){!0===window.matchMedia("(orientation: portrait)").matches?Y("landscape"):Y("portrait");var e=T,t=R;if(h){var n,a,i=w.scale(h,{maxWidth:e,maxHeight:t});S(i),i.width<e&&(n=(e-i.width)/2),i.height<t&&(a=(t-i.height)/2),G({x:n,y:a}),M({x:n,y:a,width:null,height:null})}W(t),q(e)}i.a.useEffect((function(){window.onorientationchange=function(){var e=this;K(),this.setTimeout((function(){e.window.innerHeight!==T&&K()}),400)}}),[h,l]);var Q=!1;null!==h&&(Q=!0);return!1===window.matchMedia("(orientation: ".concat(J," )"))&&K(),i.a.createElement("div",{className:a.outerContainer},i.a.createElement("div",{className:Q?a.stageContainerAfterUpload:a.stageContainerBeforeUpload},i.a.createElement(u.Stage,{visible:Q,ref:r,width:R,height:T},i.a.createElement(u.Layer,{onClick:function(){k(!1)},onTap:function(){k(!1)}},i.a.createElement(u.Image,{x:P?z.x:0,y:P?z.y:0,image:E})),i.a.createElement(u.Layer,{visible:Q},i.a.createElement(C,{backgroundImage:E,data:o,shapeProps:P,isSelected:U,onSelect:function(){k(!0)},onChange:M})))),i.a.createElement("div",{className:Q?a.buttonContainerAfterUpload:a.buttonContainerBeforeUpload},i.a.createElement("div",{className:Q?a.singleButtonContainerAfterUpload:a.singleButtonContainerBeforeUpload},i.a.createElement("label",{className:Q?a.button:a.buttonBeforeUpload,htmlFor:"files"},"Bild hochladen",i.a.createElement("input",{id:"files",visibility:"hidden",type:"file",accept:"image/*",style:{display:"none"},onChange:function(e){var t=Object(s.a)(e.target.files,1)[0];t&&w(t,(function(e){var t=w.scale(e,{maxWidth:R,maxHeight:T});S(t),f(e),function(e){var t,n;e.width<R&&(t=(R-e.width)/2),e.height<T&&(n=(T-e.height)/2),G({x:t,y:n}),M({x:t,y:n,width:null,height:null})}(t)}),{orientation:!0})}}))),i.a.createElement("div",{style:Q?{visibility:"visible"}:{visibility:"hidden"},className:a.singleButtonContainerAfterUpload},i.a.createElement("label",{className:a.button,onClick:function(){k(!1);var e=r.current.toDataURL({mimeType:"image/png"});Object(b.saveAs)(e,"collage.png")}},"Bild Speichern"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var E=n(17),S=n(59),O=n(60),B=n(61),U=n(12),k=new O.a,A=new B.a({uri:"https://ecoled-pcode.myshopify.com/api/graphql"}),H=Object(S.a)((function(){return{headers:{"X-Shopify-Storefront-Access-Token":"76395c75a69f934117b8da81ff64f784"}}})),T=new E.a({link:H.concat(A),cache:k});r.a.render(i.a.createElement(U.a,{client:T},i.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},62:function(e,t,n){e.exports=n(127)},67:function(e,t,n){}},[[62,1,2]]]);
//# sourceMappingURL=main.1c0a193a.chunk.js.map