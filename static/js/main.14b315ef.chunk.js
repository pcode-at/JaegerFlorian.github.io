(this["webpackJsonpecoled-collage"]=this["webpackJsonpecoled-collage"]||[]).push([[0],{127:function(e,t,n){"use strict";n.r(t);var i=n(2),a=n.n(i),o=n(52),r=n.n(o),l=(n(67),n(35)),c=n(36),d=n(14),s=n(53),h=n.n(s),u=n(19),g=n(34),w=n(37),f=n.n(w),m=n(28),p=n(136),b=n(54);function y(){var e=Object(l.a)(["\n      query query {\n        shop {\n          name\n        }\n      }\n    "]);return y=function(){return e},e}function v(){var e=Object(l.a)(['\n      query query {\n        node(id: "','") {\n          ... on Product {\n            images(first: 100) {\n              edges {\n                node {\n                  originalSrc\n                  altText\n                }\n              }\n            }\n          }\n        }\n      }\n    ']);return v=function(){return e},e}var x=Object(p.a)({outerContainer:{height:"100vh",display:"flex"},stageContainerAfterUpload:{width:"100%",alignContent:"center",alignItems:"center"},buttonContainerAfterUpload:{width:"100%",position:"absolute",bottom:0,display:"flex",justifyContent:"space-evenly"},buttonContainerBeforeUpload:{width:"100%"},singleButtonContainerBeforeUpload:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},singleButtonContainerAfterUpload:{width:"48%",display:"flex",justifyContent:"center",alignItems:"center"},button:{background:"#252a2b",fontFamily:"sans-serif",fontStyle:"normal",color:"white",border:"2px solid transparent",fontWeight:700,textTransform:"uppercase",cursor:"pointer",borderRadius:0,padding:"15px 30px",textAlign:"center",width:"100%",alignSelf:"stretch"},buttonBeforeUpload:{background:"#252a2b",fontFamily:"sans-serif",fontStyle:"normal",color:"white",border:"2px solid transparent",fontWeight:700,textTransform:"uppercase",cursor:"pointer",borderRadius:0,padding:"15px 30px",width:"50%",display:"flex",alignSelf:"center",justifyContent:"center"}}),S=function(e){var t,n,i=e.backgroundImage,o=e.data,r=e.shapeProps,l=e.isSelected,s=e.onSelect,g=e.onChange,w=a.a.useState(null),f=Object(d.a)(w,2),m=f[0],p=f[1];o&&o.node&&o.node.images&&0!==o.node.images.edges.length&&null===m&&o.node.images.edges.forEach((function(e){"collage"===e.node.altText&&p(e.node.originalSrc)}));var b=h()(m,"Anonymous"),y=Object(d.a)(b,1)[0];if(y&&r&&null===r.height&&null===r.width){var v=y.width/y.height;i&&(n=(t=i.height>i.width&&window.innerHeight>window.innerWidth?window.innerHeight/4:i.height>i.width&&window.innerHeight<window.innerWidth?window.innerHeight/3:i.height<i.width&&window.innerHeight>window.innerWidth?window.innerHeight/6:window.innerHeight/3)*v,r.width=n,r.height=t)}var x=a.a.useRef(),S=a.a.useRef();return a.a.useEffect((function(){l&&(S.current.setNode(x.current),S.current.getLayer().batchDraw())}),[l]),a.a.createElement(a.a.Fragment,null,a.a.createElement(u.Image,Object.assign({crossOrigin:"anonymous",fill:"",image:y,onTap:s,onClick:s,ref:x},r,{draggable:!0,onDragEnd:function(e){g(Object(c.a)({},r,{x:e.target.x(),y:e.target.y()}))},onTransformEnd:function(e){var t=x.current,n=t.scaleX(),i=t.scaleY();t.scaleX(1),t.scaleY(1),g(Object(c.a)({},r,{x:t.x(),y:t.y(),width:Math.max(5,t.width()*n),height:Math.max(t.height()*i)}))}})),l&&a.a.createElement(u.Transformer,{enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],ref:S,boundBoxFunc:function(e,t){return t.width<5||t.height<5?e:t}}))},j=function(){var e,t=window.location.search,n=new URLSearchParams(t).get("product_id");n?(n=btoa("gid://shopify/Product/"+n),e=f()(v(),n)):e=f()(y());var i=x(),o=Object(g.a)(e).data,r=a.a.createRef(),l=new Image,c=a.a.useState(null),s=Object(d.a)(c,2),h=s[0],w=s[1],p=a.a.useState(null),j=Object(d.a)(p,2),E=j[0],C=j[1],O=a.a.useState(!0),R=Object(d.a)(O,2),B=R[0],P=R[1],U=a.a.useState(window.innerWidth),H=Object(d.a)(U,2),k=H[0],I=H[1],W=a.a.useState(window.innerHeight),A=Object(d.a)(W,2),T=A[0],N=A[1],q=a.a.useState(null),F=Object(d.a)(q,2),L=F[0],M=F[1],D=a.a.useState(null),X=Object(d.a)(D,2),J=X[0],Q=X[1],Y=a.a.useState(null),$=Object(d.a)(Y,2),_=$[0],z=$[1],G=a.a.useState(null),K=Object(d.a)(G,2),V=K[0],Z=K[1],ee=a.a.useState(null),te=Object(d.a)(ee,2),ne=te[0],ie=te[1];function ae(){!0===window.matchMedia("(orientation: portrait)").matches?Q("landscape"):Q("portrait");var e=window.innerWidth,t=window.innerHeight;if(h){var n,i,a=m.scale(h,{maxWidth:e,maxHeight:t,downsamplingRatio:.2,pixelRatio:window.devicePixelRatio,imageSmoothingEnabled:!0,imageSmoothingQuality:"high",canvas:!0});C(a),Z(parseInt(a.style.width,10)),ie(parseInt(a.style.height,10)),a.width/window.devicePixelRatio<e&&(n=(e-a.width/window.devicePixelRatio)/2),a.height/window.devicePixelRatio<t&&(i=(t-a.height/window.devicePixelRatio)/2),z({x:n,y:i}),M({x:n,y:i,width:null,height:null})}N(t),I(e)}a.a.useEffect((function(){window.onorientationchange=function(){this.setTimeout((function(){window.innerHeight!==T&&ae()}),400)}}),[h,l]);var oe=!1;null!==h&&(oe=!0);return!1===window.matchMedia("(orientation: ".concat(J," )"))&&ae(),a.a.createElement("div",{className:i.outerContainer},a.a.createElement("div",{className:oe?i.stageContainerAfterUpload:i.stageContainerBeforeUpload},a.a.createElement(u.Stage,{visible:oe,ref:r,width:k,height:T},a.a.createElement(u.Layer,{onClick:function(){P(!1)},onTap:function(){P(!1)}},a.a.createElement(u.Image,{width:V,height:ne,x:L?_.x:0,y:L?_.y:0,image:E})),a.a.createElement(u.Layer,{visible:oe},a.a.createElement(S,{backgroundImage:E,data:o,shapeProps:L,isSelected:B,onSelect:function(){P(!0)},onChange:M})))),a.a.createElement("div",{className:oe?i.buttonContainerAfterUpload:i.buttonContainerBeforeUpload},a.a.createElement("div",{className:oe?i.singleButtonContainerAfterUpload:i.singleButtonContainerBeforeUpload},a.a.createElement("label",{className:oe?i.button:i.buttonBeforeUpload,htmlFor:"files"},"Bild hochladen",a.a.createElement("input",{id:"files",visibility:"hidden",type:"file",accept:"image/*",style:{display:"none"},onChange:function(e){var t=Object(d.a)(e.target.files,1)[0];t&&m(t,(function(e){var t=m.scale(e,{maxWidth:k,maxHeight:T,downsamplingRatio:.2,pixelRatio:window.devicePixelRatio,imageSmoothingEnabled:!0,imageSmoothingQuality:"high",canvas:!0});console.log(t),C(t),w(e),function(e){var t,n;e.width/window.devicePixelRatio<window.innerWidth&&(t=(window.innerWidth-e.width/window.devicePixelRatio)/2),e.height/window.devicePixelRatio<window.innerHeight&&(n=(window.innerHeight-e.height/window.devicePixelRatio)/2),z({x:t,y:n}),M({x:t,y:n,width:null,height:null})}(t),t.style&&t.style.height||t.style&&t.style.width?(Z(parseInt(t.style.width,10)),ie(parseInt(t.style.height,10))):(console.log(t.width),Z(t.width),ie(t.height))}),{orientation:!0})}}))),a.a.createElement("div",{style:oe?{visibility:"visible"}:{visibility:"hidden"},className:i.singleButtonContainerAfterUpload},a.a.createElement("label",{className:i.button,onClick:function(){P(!1),setTimeout((function(){var e=r.current.toDataURL({pixelRatio:window.devicePixelRatio,mimeType:"image/png"});Object(b.saveAs)(e,"collage.png")}),150)}},"Bild Speichern"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var E=n(17),C=n(59),O=n(60),R=n(61),B=n(12),P=new O.a,U=new R.a({uri:"https://ecoled-pcode.myshopify.com/api/graphql"}),H=Object(C.a)((function(){return{headers:{"X-Shopify-Storefront-Access-Token":"76395c75a69f934117b8da81ff64f784"}}})),k=new E.a({link:H.concat(U),cache:P});r.a.render(a.a.createElement(B.a,{client:k},a.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},62:function(e,t,n){e.exports=n(127)},67:function(e,t,n){}},[[62,1,2]]]);
//# sourceMappingURL=main.14b315ef.chunk.js.map